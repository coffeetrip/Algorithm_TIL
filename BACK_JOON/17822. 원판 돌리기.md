# 17822. 원판 돌리기

```python
def f(p):
    visited = [[0]*M for _ in range(N)]
    di = [-1, 0, 1, 0]
    dj = [0, 1, 0, -1]
    total = 1
    s = 0
    for i in range(N):
        for j in range(M):
            check = 1
            s += p[i][j]
            if j == 0:
                if p[i][j] == p[i][M-1] and p[i][j] != 0:
                    total = 0
                    check = 0
                    visited[i][M-1] = 1
            elif j == M-1:
                if p[i][j] == p[i][0] and p[i][j] != 0:
                    total = 0
                    check = 0
                    visited[i][0] = 1
            for k in range(4):
                ni, nj = i + di[k], j + dj[k]
                if 0 <= ni < N and 0 <= nj < M and visited[ni][nj] == 0 and p[ni][nj] != 0:
                    if p[i][j] == p[ni][nj]:
                        total = 0
                        check = 0
                        visited[ni][nj] = 1
            if check == 0:
                visited[i][j] = 1
    if total == 1:
        cnt = 0
        for a in range(N):
            for b in range(M):
                if p[a][b] != 0:
                    cnt += 1
        if cnt == 0:
            ave = s
        else:
            ave = s / cnt
        for a in range(N):
            for b in range(M):
                if p[a][b] != 0:
                    if p[a][b] > ave:
                        p[a][b] -= 1
                    elif p[a][b] < ave:
                        p[a][b] += 1
    else:
        for a in range(N):
            for b in range(M):
                if visited[a][b] == 1:
                    p[a][b] = 0
    return p


N, M, T = map(int, input().split())  # 반지름, 적힌 개수
arr = [list(map(int, input().split())) for _ in range(N)]

for i in range(T):
    x, d, m = map(int, input().split())
    for j in range(x-1, N, x):
        if d == 1:
            arr[j] = arr[j][m:] + arr[j][:m]
        else:
            arr[j] = arr[j][M-m:] + arr[j][:M-m]
    arr = f(arr)
s = 0
for i in range(N):
    for j in range(M):
        s += arr[i][j]
print(s)
```

